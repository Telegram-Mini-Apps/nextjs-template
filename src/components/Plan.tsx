import { UserResponseDto } from '@/app/dto/user.dto';
import Link from 'next/link';
import { useEffect, useState } from 'react';
import { BsShieldLock } from 'react-icons/bs';
import { FaStackExchange } from 'react-icons/fa';
import { addAbortSignal } from 'stream';
import Image from 'next/image';
interface PlanProps {
  data: string;
}

const Plan: React.FC<PlanProps> = ({ data }) => {


  const [subscribed, setSubscribed] = useState(false);
  const [checking, setChecking] = useState(false);

  // Функция для проверки подписки
  const checkSubscription = async () => {
    setChecking(true); // Устанавливаем состояние загрузки
    try {
      // Имитация запроса к серверу
      const response = await fetch('/api/check-subscription', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ userId: 'exampleUserId' }), // Замените на реальные данные
      });

      const data = await response.json();

      if (data.success) {
        alert('Вы подписаны!'); // Успешный результат
      } else {
        alert('Подписка не найдена. Подпишитесь на канал!');
      }
    } catch (error) {
      console.error('Ошибка при проверке подписки:', error);
      alert('Ошибка при проверке подписки. Попробуйте позже.');
    } finally {
      setChecking(false); // Снимаем состояние загрузки
    }
  };

  return (

    <>
      <div>
        <div className='logo'>
          <h2 className='logo_h2'>FreeTube VPN</h2>
        </div>
        <div className='advantages'>
          <div className="advantage_block">
            <p className='advantege_title'><span className='advantage_block_img'>
              <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g clip-path="url(#clip0_1_4545)">
                  <path d="M5.05375 10.0888C5.625 0.7075 10.8825 0.0325 11.125 0.0075C11.1665 0.00274143 11.2082 0.000237754 11.25 0C12.3335 0.0430721 13.3816 0.397652 14.2687 1.02125C14.4828 1.17244 14.7385 1.25362 15.0006 1.25362C15.2627 1.25362 15.5184 1.17244 15.7325 1.02125C16.6191 0.397623 17.6669 0.0430287 18.75 0C18.7939 6.10251e-06 18.8377 0.00251016 18.8812 0.0075C19.1175 0.0325 24.3813 0.7075 24.9463 10.0888C24.959 10.2814 24.9107 10.4732 24.8081 10.6369C24.7056 10.8005 24.554 10.9275 24.375 11C21.3721 12.085 18.1915 12.5939 15 12.5C11.8085 12.5938 8.62792 12.0849 5.625 11C5.446 10.9275 5.29442 10.8005 5.19186 10.6369C5.08929 10.4732 5.04096 10.2814 5.05375 10.0888ZM28.3663 12.4863C28.1794 12.3552 27.9584 12.2813 27.7302 12.2735C27.5021 12.2657 27.2766 12.3245 27.0813 12.4425C25.705 13.25 21.9225 15 15 15C8.0775 15 4.29625 13.25 2.91875 12.4425C2.72337 12.3245 2.49789 12.2657 2.26975 12.2735C2.04161 12.2813 1.82065 12.3552 1.63375 12.4863C1.18177 12.7459 0.797951 13.1092 0.513906 13.5462C0.229861 13.9833 0.0537214 14.4815 0 15C0 19.6125 7.7425 20 15 20C22.2575 20 30 19.6125 30 15C29.9463 14.4815 29.7701 13.9833 29.4861 13.5462C29.202 13.1092 28.8182 12.7459 28.3663 12.4863V12.4863ZM20.625 21.25C19.7575 21.251 18.9099 21.5099 18.1899 21.9938C17.4698 22.4777 16.9099 23.1647 16.5813 23.9675C15.547 23.6775 14.453 23.6775 13.4187 23.9675C13.0197 23 12.2865 22.208 11.3527 21.7356C10.4188 21.2632 9.34642 21.1419 8.33063 21.3936C7.31483 21.6454 6.4232 22.2535 5.81802 23.1073C5.21285 23.9611 4.93437 25.0038 5.03328 26.0456C5.13218 27.0875 5.6019 28.0592 6.35692 28.7838C7.11195 29.5085 8.10208 29.938 9.1471 29.9941C10.1921 30.0502 11.2225 29.7292 12.0508 29.0895C12.8791 28.4498 13.4501 27.534 13.66 26.5088C14.0905 26.3533 14.5426 26.266 15 26.25C15.4574 26.2659 15.9095 26.3532 16.34 26.5088C16.5071 27.3191 16.9007 28.0655 17.4749 28.6612C18.0491 29.2569 18.7805 29.6776 19.5842 29.8744C20.3879 30.0712 21.2309 30.0361 22.0154 29.7731C22.7999 29.5101 23.4938 29.03 24.0164 28.3886C24.5391 27.7472 24.8692 26.9706 24.9683 26.1492C25.0674 25.3277 24.9316 24.495 24.5765 23.7476C24.2215 23.0002 23.6617 22.3689 22.9623 21.9268C22.2629 21.4847 21.4524 21.25 20.625 21.25V21.25Z" fill="url(#paint0_linear_1_4545)" />
                </g>
                <defs>
                  <linearGradient id="paint0_linear_1_4545" x1="15" y1="-14" x2="15" y2="57" gradientUnits="userSpaceOnUse">
                    <stop offset="0.495" stop-color="#322F69" />
                    <stop offset="1" stop-color="#030026" />
                  </linearGradient>
                  <clipPath id="clip0_1_4545">
                    <rect width="30" height="30" fill="white" />
                  </clipPath>
                </defs>
              </svg>
            </span>
              <span className='advantage_block_title'>Анонимность</span></p>
            <p className='advantege_desc'>Скрывайте свой IP с помощью<br />
              анонимного серфинга</p>
          </div>
          <div className="advantage_block">
            <p className='advantege_title'><span className='advantage_block_img'>
              <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g clip-path="url(#clip0_1_4557)">
                  <path d="M29.1887 0.811276C28.8199 0.438382 28.3515 0.179432 27.8396 0.0652933C27.3276 -0.0488454 26.7936 -0.0133576 26.3012 0.167526L26.0312 0.263776C19.9851 2.23034 14.4807 5.57939 9.955 10.045C8.81923 11.2108 7.78584 12.4721 6.86625 13.815C5.11625 16.315 4.78375 19.0513 6.93375 21.2025L6.9825 21.25L4.11625 24.1163C3.88191 24.3507 3.75027 24.6686 3.75027 25C3.75027 25.3315 3.88191 25.6494 4.11625 25.8838C4.35066 26.1181 4.66854 26.2498 5 26.2498C5.33145 26.2498 5.64934 26.1181 5.88375 25.8838L8.75 23.0175L8.7975 23.0663C10.9487 25.2163 13.6912 24.8813 16.185 23.1338C17.5279 22.2142 18.7892 21.1808 19.955 20.045C24.4208 15.519 27.7699 10.0141 29.7362 3.96753L29.8325 3.69753C30.0134 3.20538 30.0489 2.67157 29.9348 2.15979C29.8207 1.64802 29.5617 1.17989 29.1887 0.811276V0.811276ZM13.75 17.5C13.5028 17.5 13.2611 17.4267 13.0555 17.2894C12.85 17.152 12.6898 16.9568 12.5951 16.7284C12.5005 16.5 12.4758 16.2486 12.524 16.0062C12.5722 15.7637 12.6913 15.541 12.8661 15.3661C13.0409 15.1913 13.2637 15.0723 13.5061 15.024C13.7486 14.9758 13.9999 15.0006 14.2284 15.0952C14.4568 15.1898 14.652 15.35 14.7893 15.5556C14.9267 15.7611 15 16.0028 15 16.25C15 16.5815 14.8683 16.8995 14.6339 17.1339C14.3995 17.3683 14.0815 17.5 13.75 17.5ZM17.5 13.75C17.2528 13.75 17.0111 13.6767 16.8055 13.5394C16.6 13.402 16.4398 13.2068 16.3451 12.9784C16.2505 12.75 16.2258 12.4986 16.274 12.2562C16.3222 12.0137 16.4413 11.791 16.6161 11.6161C16.7909 11.4413 17.0137 11.3223 17.2561 11.274C17.4986 11.2258 17.7499 11.2506 17.9784 11.3452C18.2068 11.4398 18.402 11.6 18.5393 11.8056C18.6767 12.0111 18.75 12.2528 18.75 12.5C18.75 12.8315 18.6183 13.1495 18.3839 13.3839C18.1495 13.6183 17.8315 13.75 17.5 13.75ZM21.25 10C21.0028 10 20.7611 9.92672 20.5555 9.78936C20.35 9.65201 20.1898 9.45679 20.0951 9.22838C20.0005 8.99997 19.9758 8.74864 20.024 8.50616C20.0722 8.26369 20.1913 8.04096 20.3661 7.86614C20.5409 7.69133 20.7637 7.57228 21.0061 7.52404C21.2486 7.47581 21.4999 7.50057 21.7284 7.59518C21.9568 7.68979 22.152 7.85 22.2893 8.05556C22.4267 8.26113 22.5 8.5028 22.5 8.75003C22.5 9.08155 22.3683 9.39949 22.1339 9.63391C21.8995 9.86833 21.5815 10 21.25 10ZM2.95375 16.2975C2.56592 16.2977 2.18185 16.2214 1.82349 16.0731C1.46514 15.9248 1.13951 15.7074 0.865209 15.4332C0.590912 15.159 0.37332 14.8335 0.224865 14.4752C0.07641 14.1169 -3.4758e-08 13.7329 0 13.345C0.00302173 12.575 0.30042 11.8353 0.83125 11.2775C2.96669 9.08234 5.84855 7.769 8.90625 7.59753C8.6675 7.82503 8.42375 8.04128 8.1875 8.27753C6.94957 9.5446 5.82253 10.9155 4.81875 12.375C3.97462 13.5445 3.38681 14.879 3.09375 16.2913L2.95375 16.2975ZM13.75 26.9063C15.1624 26.6138 16.497 26.0259 17.6662 25.1813C19.1282 24.1781 20.5012 23.051 21.77 21.8125C22.0075 21.5763 22.2225 21.3325 22.4512 21.0938C22.2787 24.1515 20.965 27.0331 18.77 29.1688C18.2127 29.6996 17.4734 29.9971 16.7037 30C15.9204 30 15.1691 29.6888 14.6151 29.1349C14.0612 28.581 13.75 27.8297 13.75 27.0463V26.9063Z" fill="url(#paint0_linear_1_4557)" />
                </g>
                <defs>
                  <linearGradient id="paint0_linear_1_4557" x1="15" y1="-11.5" x2="15" y2="58.5" gradientUnits="userSpaceOnUse">
                    <stop offset="0.505" stop-color="#322F69" />
                    <stop offset="1" stop-color="#030026" />
                  </linearGradient>
                  <clipPath id="clip0_1_4557">
                    <rect width="30" height="30" fill="white" />
                  </clipPath>
                </defs>
              </svg>
            </span>
              <span className='advantage_block_title'>Быстро</span></p>
            <p className='advantege_desc'>Скорость до 1 Gbps
              для комфортного использования<br /></p>
          </div>
          <div className="advantage_block">
            <p className='advantege_title'><span className='advantage_block_img'>
              <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g clip-path="url(#clip0_1_4549)">
                  <path d="M15 0C12.0333 0 9.13319 0.879735 6.66645 2.52796C4.19972 4.17618 2.27713 6.51886 1.14181 9.25975C0.00649929 12.0006 -0.290551 15.0166 0.288228 17.9264C0.867006 20.8361 2.29562 23.5088 4.3934 25.6066C6.49119 27.7044 9.16394 29.133 12.0737 29.7118C14.9834 30.2906 17.9994 29.9935 20.7403 28.8582C23.4812 27.7229 25.8238 25.8003 27.472 23.3336C29.1203 20.8668 30 17.9667 30 15C29.9957 11.0231 28.414 7.21026 25.6019 4.39815C22.7897 1.58604 18.9769 0.00430135 15 0ZM20 16.25H16.25H13.75H10C9.66849 16.25 9.35054 16.1183 9.11612 15.8839C8.8817 15.6495 8.75001 15.3315 8.75001 15C8.75001 14.6685 8.8817 14.3505 9.11612 14.1161C9.35054 13.8817 9.66849 13.75 10 13.75H13.75H16.25H20C20.3315 13.75 20.6495 13.8817 20.8839 14.1161C21.1183 14.3505 21.25 14.6685 21.25 15C21.25 15.3315 21.1183 15.6495 20.8839 15.8839C20.6495 16.1183 20.3315 16.25 20 16.25Z" fill="url(#paint0_linear_1_4549)" />
                </g>
                <defs>
                  <linearGradient id="paint0_linear_1_4549" x1="15" y1="-15.5" x2="15" y2="53" gradientUnits="userSpaceOnUse">
                    <stop offset="0.5" stop-color="#322F69" />
                    <stop offset="1" stop-color="#030026" />
                  </linearGradient>
                  <clipPath id="clip0_1_4549">
                    <rect width="30" height="30" fill="white" />
                  </clipPath>
                </defs>
              </svg>
            </span>
              <span className='advantage_block_title'>Без рекламы</span></p>
            <p className='advantege_desc'>Наслаждайтесь приложением<br />
              без назойливой рекламы</p>
          </div>
          <div className="advantage_block">
            <p className='advantege_title'><span className='advantage_block_img'>
              <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g clip-path="url(#clip0_1_4553)">
                  <path d="M23.2263 2.675L15.395 0.0637458C15.1386 -0.0216555 14.8614 -0.0216555 14.605 0.0637458L6.77375 2.675C5.52863 3.0886 4.44552 3.88407 3.67831 4.94838C2.91109 6.0127 2.4988 7.29173 2.5 8.60375V15C2.5 24.4537 14 29.675 14.4925 29.8925C14.6523 29.9635 14.8252 30.0002 15 30.0002C15.1748 30.0002 15.3477 29.9635 15.5075 29.8925C16 29.675 27.5 24.4537 27.5 15V8.60375C27.5012 7.29173 27.0889 6.0127 26.3217 4.94838C25.5545 3.88407 24.4714 3.0886 23.2263 2.675V2.675ZM20.8975 12.1462L15.5575 17.4862C15.339 17.7062 15.0789 17.8806 14.7925 17.9993C14.506 18.1179 14.1988 18.1785 13.8888 18.1775H13.8475C13.5311 18.1727 13.219 18.1037 12.93 17.9748C12.641 17.8459 12.3812 17.6597 12.1663 17.4275L9.28375 14.4275C9.15892 14.3117 9.05906 14.1716 8.99032 14.0158C8.92157 13.86 8.88539 13.6918 8.88398 13.5215C8.88257 13.3512 8.91597 13.1824 8.98213 13.0255C9.04829 12.8686 9.14581 12.7269 9.26871 12.609C9.39162 12.4911 9.53731 12.3996 9.69685 12.3401C9.85639 12.2805 10.0264 12.2542 10.1965 12.2627C10.3666 12.2712 10.5331 12.3144 10.6859 12.3896C10.8387 12.4648 10.9745 12.5704 11.085 12.7L13.89 15.625L19.125 10.375C19.3608 10.1473 19.6765 10.0213 20.0043 10.0242C20.332 10.027 20.6455 10.1585 20.8773 10.3902C21.109 10.622 21.2405 10.9355 21.2433 11.2632C21.2462 11.591 21.1202 11.9067 20.8925 12.1425L20.8975 12.1462Z" fill="url(#paint0_linear_1_4553)" />
                </g>
                <defs>
                  <linearGradient id="paint0_linear_1_4553" x1="15" y1="-26.5" x2="13" y2="56" gradientUnits="userSpaceOnUse">
                    <stop offset="0.5" stop-color="#322F69" />
                    <stop offset="1" stop-color="#030026" />
                  </linearGradient>
                  <clipPath id="clip0_1_4553">
                    <rect width="30" height="30" fill="white" />
                  </clipPath>
                </defs>
              </svg>
            </span>
              <span className='advantage_block_title'>Безопасность</span></p>
            <p className='advantege_desc'>Передача трафика через<br />
              зашифрованный туннель</p>
          </div>
        </div>
      </div>

      <div className='price_btn_block'>
        {data == 'new' ?
          <>

            <p>Подпишитесь на наш канал и получите бесплатный доступ к VPN на 3 дня. Быстрая, безопасная и анонимная связь без ограничений — только для наших подписчиков!

              Оставаться на связи еще никогда не было так просто. Подпишитесь прямо сейчас и начните пользоваться преимуществами! 🚀</p>

            {!subscribed ? (
              <Link
                className="price_btn_main_sale"
                href="https://t.me/FreeTubeVpn"
                onClick={() => setSubscribed(true)}
              >
                3 дня <span className="subscribe">Подписка на наш канал</span>
                <Image className="starPrice" src="/img/star.gif" alt="" />
              </Link>
            ) : (
              <button
                className="price_btn_main_sale"
                onClick={checkSubscription}
                disabled={checking} // Блокируем кнопку во время загрузки
              >
                {checking ? 'Проверяем...' : 'Проверить подписку'}
              </button>
            )}
          </> : ''}

        <Link className='price_btn_main' href={'/'}> <span>30 дней</span> <span></span> <span>250 <Image className='starPrice' src="/img/star.gif" alt="" /></span> </Link>
        <Link className='price_btn_main' href={'/'}> <span>90 дней</span> <span>- 10%</span>  <span>675 <Image className='starPrice' src="/img/star.gif" alt="" /></span> </Link>
        <Link className='price_btn_main' href={'/'}> <span>180 дней</span> <span>- 20%</span> <span>1200 <Image className='starPrice' src="/img/star.gif" alt="" /></span> </Link>
        <Link className='price_btn_main_more' href={"/"}>Подробнее</Link>
      </div>
    </>

  );
};

export default Plan;
